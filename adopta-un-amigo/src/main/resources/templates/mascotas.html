<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mascotas</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="container">
        <h1 class="mt-5">Mascotas en Adopción</h1>
        <div id="mascotas" class="mt-3"></div>
        
        <h2 class="mt-5">Agregar Nueva Mascota</h2>
        <form id="mascotaForm">
            <div class="form-group">
                <label for="nombre">Nombre:</label>
                <input type="text" class="form-control" id="nombre" name="nombre" required>
            </div>
            <div class="form-group">
                <label for="raza">Raza:</label>
                <input type="text" class="form-control" id="raza" name="raza" required>
            </div>
            <div class="form-group">
                <label for="edad">Edad:</label>
                <input type="number" class="form-control" id="edad" name="edad" required>
            </div>
            <button type="submit" class="btn btn-primary">Agregar</button>
        </form>
    </div>

    <script>
        $(document).ready(function() {
            // Cargar la lista de mascotas
            function loadMascotas() {
                $.ajax({
                    url: '/api/mascotas',
                    type: 'GET',
                    success: function(data) {
                        let html = '<table class="table table-striped">';
                        html += '<thead><tr><th>Nombre</th><th>Raza</th><th>Edad</th></tr></thead><tbody>';
                        data.forEach(function(mascota) {
                            html += `<tr><td>${mascota.nombre}</td><td>${mascota.raza}</td><td>${mascota.edad}</td></tr>`;
                        });
                        html += '</tbody></table>';
                        $('#mascotas').html(html);
                    },
                    error: function(err) {
                        console.error('Error obteniendo las mascotas', err);
                    }
                });
            }

            // Llamar a la función para cargar las mascotas al cargar la página
            loadMascotas();

            // Manejar el envío del formulario
            $('#mascotaForm').on('submit', function(event) {
                event.preventDefault();

                const mascotaData = {
                    nombre: $('#nombre').val(),
                    raza: $('#raza').val(),
                    edad: $('#edad').val()
                };

                $.ajax({
                    url: '/api/mascotas',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(mascotaData),
                    success: function(response) {
                        alert('Mascota agregada exitosamente!');
                        $('#mascotaForm')[0].reset();
                        loadMascotas();
                    },
                    error: function(err) {
                        console.error('Error agregando la mascota', err);
                    }
                });
            });
        });
    </script>
</body>
</html>




